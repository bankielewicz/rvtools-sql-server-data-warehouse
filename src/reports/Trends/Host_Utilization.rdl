<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>Historical host CPU and memory utilization trends</Description>
  <Author>RVTools Data Warehouse</Author>
  <DataSources>
    <DataSource Name="RVToolsDW">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString>Data Source=localhost;Initial Catalog=RVToolsDW</ConnectString>
        <IntegratedSecurity>true</IntegratedSecurity>
      </ConnectionProperties>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="HostUtilization">
      <Query>
        <DataSourceName>RVToolsDW</DataSourceName>
        <CommandText>
SELECT SnapshotDate, HostName, VI_SDK_Server, Datacenter, Cluster,
       CPU_Usage_Percent, Memory_Usage_Percent,
       Total_Cores, Total_vCPUs, vCPU_to_Core_Ratio,
       Physical_Memory_MiB / 1024.0 AS Physical_Memory_GiB,
       VM_Count, in_Maintenance_Mode
FROM [Reporting].[vw_Trends_Host_Utilization]
WHERE (@VI_SDK_Server IS NULL OR VI_SDK_Server = @VI_SDK_Server)
  AND SnapshotDate &gt;= DATEADD(DAY, -@LookbackDays, CAST(GETUTCDATE() AS DATE))
  AND (@ExcludeMaintenance = 0 OR in_Maintenance_Mode = '0' OR in_Maintenance_Mode = 'false')
ORDER BY HostName, SnapshotDate DESC
        </CommandText>
      </Query>
      <Fields>
        <Field Name="SnapshotDate"><DataField>SnapshotDate</DataField></Field>
        <Field Name="HostName"><DataField>HostName</DataField></Field>
        <Field Name="VI_SDK_Server"><DataField>VI_SDK_Server</DataField></Field>
        <Field Name="Cluster"><DataField>Cluster</DataField></Field>
        <Field Name="CPU_Usage_Percent"><DataField>CPU_Usage_Percent</DataField></Field>
        <Field Name="Memory_Usage_Percent"><DataField>Memory_Usage_Percent</DataField></Field>
        <Field Name="Total_Cores"><DataField>Total_Cores</DataField></Field>
        <Field Name="Total_vCPUs"><DataField>Total_vCPUs</DataField></Field>
        <Field Name="VM_Count"><DataField>VM_Count</DataField></Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="LookbackDays">
      <DataType>Integer</DataType>
      <DefaultValue><Values><Value>30</Value></Values></DefaultValue>
      <Prompt>Lookback Days</Prompt>
    </ReportParameter>
    <ReportParameter Name="ExcludeMaintenance">
      <DataType>Boolean</DataType>
      <DefaultValue><Values><Value>true</Value></Values></DefaultValue>
      <Prompt>Exclude Maintenance Mode</Prompt>
    </ReportParameter>
    <ReportParameter Name="VI_SDK_Server">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>vCenter Server (blank for all)</Prompt>
    </ReportParameter>
  </ReportParameters>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="UtilTable">
            <TablixBody>
              <TablixColumns>
                <TablixColumn><Width>0.8in</Width></TablixColumn>
                <TablixColumn><Width>1.5in</Width></TablixColumn>
                <TablixColumn><Width>0.8in</Width></TablixColumn>
                <TablixColumn><Width>0.8in</Width></TablixColumn>
                <TablixColumn><Width>0.6in</Width></TablixColumn>
                <TablixColumn><Width>0.6in</Width></TablixColumn>
                <TablixColumn><Width>0.5in</Width></TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell><CellContents><Textbox Name="H1"><Paragraphs><Paragraph><TextRuns><TextRun><Value>Date</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="H2"><Paragraphs><Paragraph><TextRuns><TextRun><Value>Host</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="H3"><Paragraphs><Paragraph><TextRuns><TextRun><Value>CPU %</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="H4"><Paragraphs><Paragraph><TextRuns><TextRun><Value>Mem %</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="H5"><Paragraphs><Paragraph><TextRuns><TextRun><Value>Cores</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="H6"><Paragraphs><Paragraph><TextRuns><TextRun><Value>vCPUs</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="H7"><Paragraphs><Paragraph><TextRuns><TextRun><Value>VMs</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell><CellContents><Textbox Name="D1"><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!SnapshotDate.Value</Value><Style><Format>d</Format></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="D2"><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!HostName.Value</Value></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="D3"><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!CPU_Usage_Percent.Value</Value><Style><Format>0.0</Format></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="D4"><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!Memory_Usage_Percent.Value</Value><Style><Format>0.0</Format></Style></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="D5"><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!Total_Cores.Value</Value></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="D6"><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!Total_vCPUs.Value</Value></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                    <TablixCell><CellContents><Textbox Name="D7"><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!VM_Count.Value</Value></TextRun></TextRuns></Paragraph></Paragraphs></Textbox></CellContents></TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <DataSetName>HostUtilization</DataSetName>
          </Tablix>
        </ReportItems>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page>
        <PageHeader>
          <Height>0.5in</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="ReportTitle">
              <Paragraphs><Paragraph><TextRuns><TextRun><Value>Host Utilization Trend Report</Value><Style><FontSize>16pt</FontSize><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns></Paragraph></Paragraphs>
              <Top>0.1in</Top><Left>0.1in</Left><Height>0.3in</Height><Width>4in</Width>
            </Textbox>
          </ReportItems>
        </PageHeader>
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportID>Host_Utilization</rd:ReportID>
</Report>
